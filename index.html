<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>BUNKER POS ‚Äî Thermal Receipt Ready</title>
  <style>
    :root{--bg:#1a1a1a;--panel:#111;--muted:#d4af37;--gold:#ffd700;}
    body{margin:0;font-family:Arial,Helvetica,sans-serif;background:var(--bg);color:var(--gold);}
    header{background:#000;padding:12px;text-align:center;font-size:24px;font-weight:700;color:gold}
    nav{display:flex;background:#000}
    nav button{flex:1;padding:12px;font-size:15px;color:gold;background:#111;border:0;cursor:pointer}
    nav button.active{background:#333}
    .container{display:flex;height:calc(100vh - 80px);flex-direction:column}
    .content{display:flex;flex:1;justify-content:space-between}
    .menu{width:68%;background:var(--panel);padding:12px;overflow:auto;border-right:2px solid var(--gold)}
    .menu h3{border-bottom:1px solid var(--gold);padding-bottom:6px;margin:0 0 8px 0}
    .menu input{width:100%;padding:8px;margin-bottom:10px;background:WHITE;border:0;color:gold;border-radius:6px}
    .category-container{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:16px}
    .category{background:PURPLE;color:gold;padding:8px 14px;border-radius:8px;cursor:pointer}
    .menu-item{display:flex;justify-content:space-between;align-items:center;padding:10px;background:#1a1a1a;border-radius:8px;margin-bottom:8px;border:1px solid rgba(255,215,0,0.04);cursor:pointer}
    .menu-item:hover{background:RED}
    .pos{width:40%;background:var(--bg);padding:16px;display:flex;flex-direction:column;align-items:center;border-left:10px solid var(--gold)}
    .receipt-card{width:100%;background:#000;color:gold;padding:18px;border-radius:20px;border:3px solid rgba(255,215,0,0.06);font-family:monospace}
    @media print {
  .receipt-header {
    font-size: 28pt !important; /* bigger for print */
    font-weight: 900 !important;
    text-align: center;
    color: #000 !important;     /* black for clarity */
    margin-bottom: 15pt;
  }
}

    .receipt-meta{font-size:20px;color:var(--muted);margin-bottom:8px}
    .receipt-items{width:100%;border-collapse:collapse;margin-bottom:8px}
    .receipt-items th,.receipt-items td{padding:10px;border-bottom:1px dashed rgba(255,215,0,0.06);text-align:left;font-size:20px}
   .receipt-total {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-weight: 900;           /* extra bold */
  font-size: 22px;            /* larger text */
  padding: 12px 8px;
  margin-top: 12px;
  border-top: 2px solid gold; /* clear divider line */
  background: rgba(255,215,0,0.1);
  border-radius: 8px;
  color: var(--gold);
}

    .small{font-size:20px;color:var(--muted)}
    .actions{display:flex;gap:8px;margin-top:10px;width:100%}
    button.action{flex:1;padding:10px;background:var(--gold);color:#000;border:0;border-radius:6px;cursor:pointer}
    button.ghost{background:#222;color:gold;border:1px solid rgba(255,215,0,0.06);padding:8px;border-radius:6px;cursor:pointer}
    label.inline{display:flex;flex-direction:column;font-size:13px;color:var(--muted);width:100%;margin-bottom:8px}
    input[type="number"], select, input[type="text"]{padding:8px;border-radius:6px;background:#111;color:gold;border:1px solid rgba(255,215,0,0.06)}
    @media print {
      @page { size: 1000mm auto; margin: 0; }
      body * { visibility: hidden; }
      #printableReceipt, #printableReceipt * { visibility: visible; }
      #printableReceipt { position: absolute; left: 0; top: 0; width: 80mm; font-family:monospace; color: #000; background: #fff; padding: 6mm; }
      #printableReceipt h2{font-size:12pt;margin:0 0 6px 0}
      #printableReceipt p, #printableReceipt table {font-size:10pt}
    }
    @media (max-width:900px){.menu{width:100%;height:50vh}.pos{width:100%}.content{flex-direction:column}}
  </style>
</head>
<body>
  <header>üñ§ THE BUNKER CAFE LUMS  üñ§</header>
  <nav>
    <button id="tab-pos" class="active" onclick="switchTab('pos')">POS</button>
    <button id="tab-report" onclick="switchTab('report')">REPORTS</button>
  </nav>

  <div class="container">
    <div class="content" id="pos-content">
      <div class="menu" id="menu">
        <h3>MENU</h3>
        <input id="search" placeholder="Search item or category..." oninput="filterMenu()" />
        <div id="categoryList" class="category-container"></div>
        <div id="menuItems"></div>
      </div>

      <div class="pos">
        <label class="inline">Cashier:
          <select id="cashier"><option>Cashier 1</option><option>Cashier 2</option></select>
        </label>

        <div id="receipt" class="receipt-card">
          <div class="receipt-header">BUNKER CAFE LUMS</div>
          <div class="receipt-meta" id="receipt-meta">No items</div>
          <table class="receipt-items" id="receipt-items" style="display:none">
            <thead><tr><th>Item</th><th>Q</th><th>‚Ç®</th></tr></thead>
            <tbody id="receipt-body"></tbody>
          </table>
          <div class="receipt-total" id="receipt-total" style="display:none">
            <div>Total</div><div id="receipt-total-value">‚Ç®0</div>
          </div>
          <div id="receipt-payment" style="display:none;margin-top:8px;font-size:13px"></div>
          <div class="small" style="margin-top:8px;text-align:center">Thank you for visiting!
Software developed by Muawviz Khan.
For more information, please contact: 0325-8575790</div>
        </div>

        <label class="inline">Payment Type:
          <select id="paymentType" onchange="onPaymentTypeChange()">
            <option value="Cash">Cash</option>
            <option value="Online">Online</option>
          </select>
        </label>

        <label class="inline" id="cashReceivedLabel">Cash Received:
          <input type="number" id="cashReceived" min="0" value="0" onchange="updateChange()" />
        </label>
        <div class="small" style="width:100%;text-align:right;margin-bottom:6px">Change: <span id="changeValue">‚Ç®0</span></div>

        <div class="actions">
          <button class="action" onclick="saveOrder()">SAVE ORDER</button>
          <button class="action" onclick="printReceipt()">PRINT</button>
        </div>
        <div class="actions" style="margin-top:8px">
          <button class="ghost" onclick="exportPDF()">EXPORT PDF</button>
          <button class="ghost" onclick="clearCart()">Clear Cart</button>
        </div>
      </div>
    </div>

    <div id="report-section" class="report-container" style="display:none">
      <h2 style="text-align:center;margin-top:0">üìä Sales Reports</h2>
      <div class="report-filter">
        <div class="filter-row">
          <label>Report Type:
            <select id="reportType" onchange="renderReport()">
              <option value="all">All Orders</option>
              <option value="cashier">By Cashier</option>
              <option value="item">By Item</option>
              <option value="category">By Category</option>
              <option value="date">By Date</option>
            </select>
          </label>
          <label>Cashier:<select id="reportCashier" onchange="renderReport()"><option value="">Any</option><option>Cashier 1</option><option>Cashier 2</option></select></label>
          <label>Item:<input id="reportItem" placeholder="Item name" oninput="renderReport()" /></label>
          <label>Category:<input id="reportCategory" placeholder="Category" oninput="renderReport()" /></label>
          <label>Start:<input type="date" id="startDate" onchange="renderReport()" /></label>
          <label>End:<input type="date" id="endDate" onchange="renderReport()" /></label>
          <div style="margin-left:auto;">
            <button class="action" onclick="renderReport()">FILTER</button>
            <button class="ghost" onclick="switchTab('pos')">‚Üê Back</button>
          </div>
        </div>
      </div>
      <div id="report-summary" class="summary-cards"></div>
      <div id="report-output"></div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
const MENU_ITEMS = [
  // Tea
  {name:'Green Tea',price:80,category:'Tea'},
  {name:'Milk Tea',price:100,category:'Tea'},

  // Coffee
  {name:'Espresso',price:180,category:'Coffee'},
  {name:'Americano',price:180,category:'Coffee'},
  {name:'Cappuccino/Latte',price:330,category:'Coffee'},
  {name:'Spanish Latte',price:330,category:'Coffee'},
  {name:'French Vanilla Latte',price:330,category:'Coffee'},
  {name:'Dark Mocha Latte',price:330,category:'Coffee'},
  {name:'Lush Caramel Latte',price:330,category:'Coffee'},
  {name:'Roasted Hazelnut Latte',price:330,category:'Coffee'},
  {name:'Cinnamon Spice Latte',price:330,category:'Coffee'},
  {name:'Sticky Toffee Latte',price:330,category:'Coffee'},

  // Iced Coffee
  {name:'Iced Americano',price:200,category:'Iced Coffee'},
  {name:'Iced Latte',price:300,category:'Iced Coffee'},
  {name:'Iced Spanish Latte',price:380,category:'Iced Coffee'},
  {name:'Iced Vanilla Latte',price:380,category:'Iced Coffee'},
  {name:'Iced Mocha Latte',price:380,category:'Iced Coffee'},
  {name:'Iced Caramel Latte',price:380,category:'Iced Coffee'},
  {name:'Iced Hazelnut Latte',price:380,category:'Iced Coffee'},
  {name:'Iced Cinnamon Latte',price:380,category:'Iced Coffee'},
  {name:'Iced Toffee Latte',price:380,category:'Iced Coffee'},

  // Iced Tea
  {name:'Peach Iced Tea',price:180,category:'Iced Tea'},
  {name:'Lemon Iced Tea',price:180,category:'Iced Tea'},
  {name:'Strawberry Iced Tea',price:180,category:'Iced Tea'},

  // Lemonade
  {name:'Passion Fruit Lemonade',price:200,category:'Lemonade'},
  {name:'Strawberry Lemonade',price:200,category:'Lemonade'},
  {name:'Mint Lemonade',price:200,category:'Lemonade'},
  {name:'Blue Ocean Lemonade',price:200,category:'Lemonade'},

  // Frappe
  {name:'Virgin Vanilla',price:430,category:'Frappe'},
  {name:'Mean Mocha',price:430,category:'Frappe'},
  {name:'Cool Caramel',price:430,category:'Frappe'},
  {name:'Hero Hazelnut',price:430,category:'Frappe'},

  // Shake
  {name:'Banana Shake',price:280,category:'Shake'},
  {name:'Strawberry Shake',price:330,category:'Shake'},
  {name:'Oreo Shake',price:330,category:'Shake'},
  {name:'Chocolate Shake',price:330,category:'Shake'},
  {name:'Lotus Shake',price:350,category:'Shake'},
  {name:'Mango Shake',price:350,category:'Shake'},
  {name:'Power House Shake',price:350,category:'Shake'},

  // Hot Choc
  {name:'Classic Belgian',price:320,category:'Hot Choc'},
  {name:'Banana Hot Choc',price:320,category:'Hot Choc'},
  {name:'Mint Hot Choc',price:320,category:'Hot Choc'},

  // Matcha
  {name:'Vanilla Iced Matcha',price:400,category:'Matcha'},
  {name:'Matcha Frappe',price:500,category:'Matcha'},

  // Smoothie
  {name:'Sunrise',price:350,category:'Smoothie'},
  {name:'Sunset in Paradise',price:350,category:'Smoothie'},
  {name:'Mint Margarita',price:250,category:'Smoothie'},

  // Slushee
  {name:'Blueberry',price:150,category:'Slushee'},
  {name:'Strawberry',price:150,category:'Slushee'},
  {name:'Green Apple',price:150,category:'Slushee'},
  {name:'Mix Berry',price:150,category:'Slushee'},
  {name:'Peach',price:150,category:'Slushee'},

  // Food
  {name:'Cheese Toastie',price:330,category:'Sandwich'},
  {name:'Chicken Panini',price:380,category:'Sandwich'},
  {name:'French Toast',price:300,category:'Breakfast'},
  {name:'Mac and Cheese',price:400,category:'Pasta'},

  // Extras
  {name:'Simple Glazed Donut',price:250,category:'Donut'},
  {name:'Boston Cream Donut',price:300,category:'Donut'},
  {name:'Nutella Donut',price:300,category:'Donut'},
  {name:'Red Velvet Donut',price:300,category:'Donut'},
  {name:'Chocolate Fudge Brownie',price:300,category:'Brownie'},
 

  // Finished Goods
  {name:'Shahbaz Cookie',price:250,category:'Finished Goods'},
  {name:'Shahbaz Brownie',price:250,category:'Finished Goods'},
  {name:'D Cookie',price:450,category:'Finished Goods'},
  {name:'Classic Cookie',price:350,category:'Finished Goods'},
  {name:'Matilda Cake',price:500,category:'Finished Goods'},
  {name:'Nut Bread',price:250,category:'Finished Goods'},
  {name:'Plain Bread',price:230,category:'Finished Goods'},

  // Disposable
  {name:'Cup',price:10,category:'Disposable'},
  {name:'Glass',price:10,category:'Disposable'},
];

let currentCart=[];let db;
// DB open/save same logic
function openDB(){return new Promise((res,rej)=>{const r=indexedDB.open('bunker-pos-db',1);r.onupgradeneeded=e=>{const _db=e.target.result;if(!_db.objectStoreNames.contains('orders'))_db.createObjectStore('orders',{keyPath:'id'})};r.onsuccess=e=>{db=e.target.result;res(db)};r.onerror=e=>rej(e.target.error);});}
function addOrderToDB(order){return new Promise((res,rej)=>{const tx=db.transaction('orders','readwrite');tx.objectStore('orders').add(order);tx.oncomplete=()=>res(true);tx.onerror=e=>rej(e.target.error);});}
function getAllOrders(){return new Promise((res,rej)=>{const tx=db.transaction('orders','readonly');const s=tx.objectStore('orders');const req=s.getAll();req.onsuccess=()=>res(req.result||[]);req.onerror=e=>rej(e.target.error);});}

function renderCategories(){const catEl=document.getElementById('categoryList');catEl.innerHTML='';const cats=[...new Set(MENU_ITEMS.map(i=>i.category))];const all=document.createElement('div');all.className='category';all.textContent='All';all.onclick=()=>renderMenu();catEl.appendChild(all);cats.forEach(c=>{const d=document.createElement('div');d.className='category';d.textContent=c;d.onclick=()=>renderMenu(MENU_ITEMS.filter(i=>i.category===c));catEl.appendChild(d);});}
function renderMenu(items=MENU_ITEMS){const c=document.getElementById('menuItems');c.innerHTML='';items.forEach(it=>{const e=document.createElement('div');e.className='menu-item';e.innerHTML=`<span>${it.name}</span><span>‚Ç®${it.price}</span>`;e.onclick=()=>addToCart(it);c.appendChild(e);});}
function filterMenu(){const q=document.getElementById('search').value.toLowerCase();const f=MENU_ITEMS.filter(i=>i.name.toLowerCase().includes(q)||i.category.toLowerCase().includes(q));renderMenu(f);}
function addToCart(it){const ex=currentCart.find(x=>x.name===it.name);if(ex)ex.qty++;else currentCart.push({...it,qty:1});updateReceipt();}
function updateReceipt(){const meta=document.getElementById('receipt-meta');const body=document.getElementById('receipt-body');const tbl=document.getElementById('receipt-items');const tot=document.getElementById('receipt-total');const tval=document.getElementById('receipt-total-value');const pay=document.getElementById('receipt-payment');
if(!currentCart.length){meta.textContent='No items';tbl.style.display=tot.style.display=pay.style.display='none';return;}
meta.textContent=new Date().toLocaleString();tbl.style.display=tot.style.display=pay.style.display='block';
body.innerHTML='';let total=0;currentCart.forEach(it=>{total+=it.price*it.qty;const r=document.createElement('tr');r.innerHTML=`<td>${it.name}</td><td>${it.qty}</td><td>${it.price*it.qty}</td>`;body.appendChild(r);});
tval.textContent='‚Ç®'+total;pay.textContent='Total: ‚Ç®'+total;}
function onPaymentTypeChange(){const t=document.getElementById('paymentType').value;document.getElementById('cashReceivedLabel').style.display=t==='Cash'?'flex':'none';updateChange();}
function updateChange(){const t=document.getElementById('paymentType').value;if(t!=='Cash')return document.getElementById('changeValue').textContent='‚Ç®0';let cash=parseFloat(document.getElementById('cashReceived').value||0);let total=currentCart.reduce((a,b)=>a+b.price*b.qty,0);let change=cash-total;if(change<0)change=0;document.getElementById('changeValue').textContent='‚Ç®'+change;}
function saveOrder(){if(!currentCart.length)return alert('Cart empty');let order={id:Date.now(),cashier:document.getElementById('cashier').value,payment:document.getElementById('paymentType').value,items:currentCart,date:new Date().toLocaleString(),total:currentCart.reduce((a,b)=>a+b.price*b.qty,0)};addOrderToDB(order).then(()=>{alert('Order saved');clearCart();}).catch(e=>alert('DB error '+e));}
function clearCart(){currentCart=[];updateReceipt();}
function printReceipt(){const r=document.getElementById('receipt').cloneNode(true);r.id='printableReceipt';document.body.appendChild(r);window.print();r.remove();}
function exportPDF(){if(!currentCart.length)return alert('Cart empty');const{jsPDF}=window.jspdf;const doc=new jsPDF({unit:'mm',format:[80,200]});doc.setFont('courier','normal');doc.text('BUNKER LUXURY',30,10);let y=20;currentCart.forEach(it=>{doc.text(`${it.name} x${it.qty} - ‚Ç®${it.price*it.qty}`,4,y);y+=6;});y+=4;doc.text('Total ‚Ç®'+currentCart.reduce((a,b)=>a+b.price*b.qty,0),4,y);doc.save('receipt.pdf');}
function switchTab(tab){if(tab==='report'){document.getElementById('pos-content').style.display='none';document.getElementById('report-section').style.display='block';document.getElementById('tab-pos').classList.remove('active');document.getElementById('tab-report').classList.add('active');renderReport();}else{document.getElementById('pos-content').style.display='flex';document.getElementById('report-section').style.display='none';document.getElementById('tab-pos').classList.add('active');document.getElementById('tab-report').classList.remove('active');}}
async function renderReport(){const orders=await getAllOrders();const type=document.getElementById('reportType').value;const cashier=document.getElementById('reportCashier').value;const item=document.getElementById('reportItem').value.toLowerCase();const cat=document.getElementById('reportCategory').value.toLowerCase();const s=document.getElementById('startDate').value;const e=document.getElementById('endDate').value;let f=orders.filter(o=>(!cashier||o.cashier===cashier)&&(!s||new Date(o.date)>=new Date(s))&&(!e||new Date(o.date)<=new Date(e)));if(item)f=f.filter(o=>o.items.some(i=>i.name.toLowerCase().includes(item)));if(cat)f=f.filter(o=>o.items.some(i=>i.category.toLowerCase().includes(cat)));let out=document.getElementById('report-output');out.innerHTML='';if(!f.length){out.textContent='No records';return;}
if(type==='all'){let html='<table class="receipt-items"><tr><th>Date</th><th>Cashier</th><th>Total</th></tr>';f.forEach(o=>html+=`<tr><td>${o.date}</td><td>${o.cashier}</td><td>‚Ç®${o.total}</td></tr>`);html+='</table>';out.innerHTML=html;}else if(type==='cashier'){let g={};f.forEach(o=>g[o.cashier]=(g[o.cashier]||0)+o.total);out.innerHTML='<table class="receipt-items"><tr><th>Cashier</th><th>Total</th></tr>'+Object.entries(g).map(([k,v])=>`<tr><td>${k}</td><td>‚Ç®${v}</td></tr>`).join('')+'</table>';}else if(type==='item'){let g={};f.forEach(o=>o.items.forEach(i=>g[i.name]=(g[i.name]||0)+i.price*i.qty));out.innerHTML='<table class="receipt-items"><tr><th>Item</th><th>Total</th></tr>'+Object.entries(g).map(([k,v])=>`<tr><td>${k}</td><td>‚Ç®${v}</td></tr>`).join('')+'</table>';}else if(type==='category'){let g={};f.forEach(o=>o.items.forEach(i=>g[i.category]=(g[i.category]||0)+i.price*i.qty));out.innerHTML='<table class="receipt-items"><tr><th>Category</th><th>Total</th></tr>'+Object.entries(g).map(([k,v])=>`<tr><td>${k}</td><td>‚Ç®${v}</td></tr>`).join('')+'</table>';}else if(type==='date'){let g={};f.forEach(o=>{let d=o.date.split(',')[0];g[d]=(g[d]||0)+o.total;});out.innerHTML='<table class="receipt-items"><tr><th>Date</th><th>Total</th></tr>'+Object.entries(g).map(([k,v])=>`<tr><td>${k}</td><td>‚Ç®${v}</td></tr>`).join('')+'</table>';}}
openDB().then(()=>{renderCategories();renderMenu();updateReceipt();});
  </script>
</body>
</html>
